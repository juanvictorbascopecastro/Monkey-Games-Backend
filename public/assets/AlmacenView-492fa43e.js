import{_ as E,N as R,O as W,S as x,a0 as Y,r as n,o as r,e as p,w as t,a as e,P as H,d as s,b as a,t as u,Q as O,L as Z,M as ee,m as z,K as G,c as S,i as U,F as K,a1 as j,j as L}from"./index-2006f269.js";import{e as te}from"./input-45862cdb.js";import{e as q,c as oe}from"./format-date-ea6389fa.js";import{i as Q}from"./picture-093c9837.js";import{P as X}from"./Paginador-8381f521.js";const ae={props:{data:{type:Object,default:null}},emits:["setData"],data(){return{inputData:{id:null,date:q(new Date),price:null,amount:0,comment:null},validateForm:null,COIN:R,imageDefault:Q}},methods:{async Validate(o){if(!this.$store.state.caja.caja){W("warning");return}if(o.preventDefault(),o.currentTarget.checkValidity()===!1&&(o.preventDefault(),o.stopPropagation()),this.validateForm=!0,!this.inputData.date){this.changueFocus("date");return}if(!this.inputData.amount){this.changueFocus("amount");return}if(this.inputData.price===null){this.changueFocus("price");return}this.preguntar()},preguntar(){this.$store.state.caja.caja.idOpened?this.saving():x.fire({title:"No se ha efectuado la apertura de caja ¿Desea continuar?",icon:"question",showCancelButton:!0,confirmButtonColor:"#321fdb",cancelButtonColor:"#bdbdbd",confirmButtonText:"ACEPTAR",cancelButtonText:"CANCELAR"}).then(async o=>{o.isConfirmed&&this.saving()})},async saving(){if(this.data){const o=new Date(this.inputData.date);o.setDate(o.getDate()+1),o.setMinutes(new Date().getMinutes()),o.setHours(new Date().getHours()),this.inputData.date=o,await this.$store.dispatch("almacen/create",{...this.inputData,idProducts:this.data.id})&&(this.$emit("setData",null),this.setData())}else Y("Seleccione el producto!","warning")},changueFocus(o){const l=te("form-ingreso-almacen",o);l&&l.focus()},setData(o=null){if(this.validateForm=!1,!o){this.inputData={id:null,date:q(new Date),price:null,amount:0,comment:null};return}this.changueFocus("amount")}},watch:{data:{immediate:!0,handler(o){this.setData(o)}}}},I=o=>(Z("data-v-d0134601"),o=o(),ee(),o),ne=I(()=>s("div",{class:"row"},[s("div",{class:"col col-sm-12"},[s("h5",{class:"mt-1"},[s("strong",null,"REGISTRAR INGRESO")])])],-1)),le={class:"row g-3"},se={class:"col-12"},ce=I(()=>s("span",{class:"text-danger"},"*",-1)),ie=["src"],de={class:"col-12"},re=I(()=>s("span",{class:"text-danger"},"*",-1)),ue={class:"col-12"},me=I(()=>s("span",{class:"text-danger"},"*",-1)),_e={class:"col-12"},pe=I(()=>s("span",{class:"text-danger"},"*",-1)),fe={class:"col-12 col-sm-12"},Ce={class:"col-12 text-end mt-2"};function ge(o,l,w,M,c,b){const y=n("CCardHeader"),g=n("CFormLabel"),C=n("CInputGroupText"),v=n("CFormInput"),h=n("CInputGroup"),m=n("CFormFeedback"),F=n("CFormTextarea"),f=n("CIcon"),k=n("CButton"),D=n("CForm"),T=n("CCardBody"),B=n("CCard");return r(),p(B,{class:"mb-4"},{default:t(()=>[e(y,null,{default:t(()=>[ne]),_:1}),e(T,null,{default:t(()=>[e(D,{class:"needs-validation",novalidate:"",validated:c.validateForm,onSubmit:H(b.Validate,["prevent"]),id:"form-ingreso-almacen"},{default:t(()=>[s("div",le,[s("div",se,[e(g,{for:"validateForm",class:"mb-0"},{default:t(()=>[a("Producto "),ce]),_:1}),e(h,null,{default:t(()=>{var _;return[e(C,{class:"p-0"},{default:t(()=>[s("img",{src:w.data&&w.data.image?o.$store.getters["product/getSrcImage"](w.data):c.imageDefault,class:"image-input"},null,8,ie)]),_:1}),e(v,{id:"validateForm",value:(_=w.data)==null?void 0:_.name,type:"text",name:"product",disabled:""},null,8,["value"])]}),_:1}),e(m,{invalid:""},{default:t(()=>[a(" El total a pagar en "+u(c.COIN)+" es requerido! ",1)]),_:1})]),s("div",de,[e(g,{for:"validatedCustom01",class:"mb-0"},{default:t(()=>[a("Fecha "),re]),_:1}),e(v,{id:"validatedCustom01",modelValue:c.inputData.date,"onUpdate:modelValue":l[0]||(l[0]=_=>c.inputData.date=_),type:"date",name:"date",required:"",onKeydown:l[1]||(l[1]=O(H(_=>b.changueFocus("amount"),["prevent"]),["enter"]))},null,8,["modelValue"]),e(m,{invalid:""},{default:t(()=>[a(" Fecha de de ingreso es requerido! ")]),_:1})]),s("div",ue,[e(g,{for:"validateForm",class:"mb-0"},{default:t(()=>[a("Cantidad "),me]),_:1}),e(v,{id:"validateForm",modelValue:c.inputData.amount,"onUpdate:modelValue":l[2]||(l[2]=_=>c.inputData.amount=_),type:"number",name:"amount",required:"",onKeydown:l[3]||(l[3]=O(H(_=>b.changueFocus("price"),["prevent"]),["enter"]))},null,8,["modelValue"]),e(m,{invalid:""},{default:t(()=>[a(" La cantidad debe ser numerico mayor a cero! ")]),_:1})]),s("div",_e,[e(g,{for:"validateForm",class:"mb-0"},{default:t(()=>[a("Total a pagar "),pe]),_:1}),e(h,null,{default:t(()=>[e(v,{id:"validateForm",modelValue:c.inputData.price,"onUpdate:modelValue":l[4]||(l[4]=_=>c.inputData.price=_),type:"number",name:"price",required:"",onKeydown:l[5]||(l[5]=O(H(_=>b.changueFocus("comment"),["prevent"]),["enter"]))},null,8,["modelValue"]),e(C,null,{default:t(()=>[s("b",null,u(c.COIN),1)]),_:1})]),_:1}),e(m,{invalid:""},{default:t(()=>[a(" El total a pagar en "+u(c.COIN)+" es requerido! ",1)]),_:1})]),s("div",fe,[e(F,{id:"validatedCustom01",label:"Comentario",modelValue:c.inputData.comment,"onUpdate:modelValue":l[6]||(l[6]=_=>c.inputData.comment=_),placeholder:"Comentario...",name:"comment",rows:"2"},null,8,["modelValue"])])]),s("div",Ce,[e(k,{color:"secondary",type:"button",class:"me-1",onClick:l[7]||(l[7]=_=>{b.setData(),this.$emit("setData",null)})},{default:t(()=>[e(f,{icon:"cil-X"}),a(" Limpiar ")]),_:1}),e(k,{color:"primary",type:"submit"},{default:t(()=>[e(f,{icon:"cil-save"}),a(" Registrar ")]),_:1})])]),_:1},8,["validated","onSubmit"])]),_:1})]),_:1})}const ve=E(ae,[["render",ge],["__scopeId","data-v-d0134601"]]),he={props:{visible:{type:Boolean,default:!1}},data(){return{COIN:R,listFilter:[]}},computed:{...z("almacen",["list","isLoading"])},methods:{convertDate:oe,...G("almacen",["loadData"]),msgDelete(o){x.fire({title:`¿Esta seguro que desea cancelar el ingreso de ${o.Product.name}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#bdbdbd",confirmButtonText:"CANCELAR",cancelButtonText:"NO CANCELAR"}).then(l=>{l.isConfirmed&&this.$store.dispatch("almacen/remove",o.id)})}},watch:{visible:{immediate:!0,handler(o){o===!0&&this.list.length<=0&&this.loadData()}}},components:{Paginador:X}},be={class:"row g-3"},ye={class:"col-12 col-md-12"},De=["src"],ke=s("h6",null,"No hay registros!",-1);function we(o,l,w,M,c,b){const y=n("CModalTitle"),g=n("CModalHeader"),C=n("CTableHeaderCell"),v=n("CTableRow"),h=n("CTableHead"),m=n("CTableDataCell"),F=n("CBadge"),f=n("CIcon"),k=n("CButton"),D=n("CTableBody"),T=n("CSpinner"),B=n("CTable"),_=n("Paginador"),P=n("CModalBody"),A=n("CModalFooter"),$=n("CModal");return r(),p($,{alignment:"center",visible:w.visible,backdrop:"static",size:"xl",onClose:l[3]||(l[3]=()=>{o.$emit("visible",!1)})},{default:t(()=>[e(g,null,{default:t(()=>[e(y,null,{default:t(()=>[a("REGISTROS DE INGRESO DE PRODUCTOS ")]),_:1})]),_:1}),e(P,null,{default:t(()=>[s("div",be,[s("div",ye,[e(B,{responsive:"",size:"sm"},{default:t(()=>[e(h,null,{default:t(()=>[e(v,null,{default:t(()=>[e(C,{scope:"col"},{default:t(()=>[a("Producto")]),_:1}),e(C,{scope:"col"},{default:t(()=>[a("Cantidad")]),_:1}),e(C,{scope:"col"},{default:t(()=>[a("Consto")]),_:1}),e(C,{scope:"col"},{default:t(()=>[a("Fecha")]),_:1}),e(C,{scope:"col"},{default:t(()=>[a("Usuario")]),_:1}),e(C,{scope:"col"},{default:t(()=>[a("Caja")]),_:1}),e(C,{scope:"col"},{default:t(()=>[a("Accion")]),_:1})]),_:1})]),_:1}),o.list.length>0?(r(),p(D,{key:0},{default:t(()=>[(r(!0),S(K,null,U(o.list,(d,V)=>(r(),p(v,{key:V},{default:t(()=>[e(m,{scope:"row",class:"p-0"},{default:t(()=>[s("img",{src:d.Product.image?o.$store.getters["product/getSrcImage"](d.Product):o.imageDefault,class:"image-table"},null,8,De),a(" "+u(d.Product.name),1)]),_:2},1024),e(m,null,{default:t(()=>[d.amount>10?(r(),p(F,{key:0,color:"success"},{default:t(()=>[a(u(d.amount)+" und.",1)]),_:2},1024)):d.amount<=10&&d.amount>0?(r(),p(F,{key:1,color:"warning"},{default:t(()=>[a(u(d.amount)+" und.",1)]),_:2},1024)):(r(),p(F,{key:2,color:"danger"},{default:t(()=>[a(u(d.amount)+" und.",1)]),_:2},1024))]),_:2},1024),e(m,null,{default:t(()=>[a(u(d.price)+" "+u(c.COIN),1)]),_:2},1024),e(m,null,{default:t(()=>[a(u(b.convertDate(d.date)),1)]),_:2},1024),e(m,null,{default:t(()=>[a(u(d.User.name)+" "+u(d.User.lastName||""),1)]),_:2},1024),e(m,null,{default:t(()=>[a(u(d.Caja.name),1)]),_:2},1024),e(m,null,{default:t(()=>[e(k,{color:"danger",size:"sm",class:"me-1",onClick:i=>b.msgDelete(d)},{default:t(()=>[e(f,{icon:"cil-trash"}),a(" Cancelar ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):o.isLoading?(r(),p(D,{key:1},{default:t(()=>[e(v,null,{default:t(()=>[e(m,{colspan:"7",class:"text-center p-4"},{default:t(()=>[e(T,{color:"primary"})]),_:1})]),_:1})]),_:1})):(r(),p(D,{key:2},{default:t(()=>[e(v,null,{default:t(()=>[e(m,{colspan:"7",class:"text-center p-4"},{default:t(()=>[ke]),_:1})]),_:1})]),_:1}))]),_:1}),e(_,{list:o.list,elementosPorPagina:10,onSetData:l[0]||(l[0]=d=>c.listFilter=d)},null,8,["list"])])])]),_:1}),e(A,null,{default:t(()=>[e(k,{color:"success",type:"button",onClick:l[1]||(l[1]=d=>o.loadData())},{default:t(()=>[e(f,{icon:"cil-sync"}),a(" Actualizar ")]),_:1}),e(k,{color:"primary",type:"button",onClick:l[2]||(l[2]=d=>o.$emit("visible",!1))},{default:t(()=>[a(" Aceptar ")]),_:1})]),_:1})]),_:1},8,["visible"])}const Fe=E(he,[["render",we]]),Te={data(){return{data:null,COIN:R,imageDefault:Q,modalHistory:!1,config:null,listFilter:[]}},computed:{...z("product",["list","isLoading"])},mounted(){this.list.length<=0&&this.loadData(),this.config=this.$store.getters["config/getByName"](j)},methods:{...G("product",["loadData"]),setItem(o){console.log(o)}},watch:{"$store.state.config.config"(o){o&&(this.config=this.$store.getters["config/getByName"](j))}},components:{NewStock:ve,HistoryAlmacen:Fe,Paginador:X}},Be={class:"row"},Se={key:0,class:"col col-12"},Ie={class:"alert alert-warning row",role:"alert"},Ne=s("div",{class:"col-12 col-sm-8"},[s("b",null,"Advertencia!"),a(" No se ha efectuado la apertura de caja! ")],-1),He={class:"col-12 col-sm-4 text-end"},Pe={key:1,class:"col-12"},Ae=s("div",null,[s("b",null,"IMPORTANTE"),a(" Es importante tener en cuenta que las ventas no maneja el control de stock. Esto significa que las ventas se pueden realizar aunque no haya suficiente stock disponible para el producto en cuestión ")],-1),$e={class:"col col-12 col-sm-8"},Ve={class:"row"},Oe=s("div",{class:"col-12 col-sm-6"},[s("h5",{class:"mt-1"},[s("strong",null,"STOCK DE PRODUCTOS")])],-1),Ee={class:"col-12 col-sm-6 text-end"},Re=["src"],Me=s("h6",null,"No hay registros!",-1),je={class:"col col-12 col-sm-4"},Le={class:"col-12"};function qe(o,l,w,M,c,b){const y=n("CIcon"),g=n("CButton"),C=n("CAlert"),v=n("CCardHeader"),h=n("CTableHeaderCell"),m=n("CTableRow"),F=n("CTableHead"),f=n("CTableDataCell"),k=n("CFormSwitch"),D=n("CBadge"),T=n("CTableBody"),B=n("CSpinner"),_=n("CTable"),P=n("Paginador"),A=n("CCardBody"),$=n("CCard"),d=n("NewStock"),V=n("HistoryAlmacen");return r(),S("div",Be,[o.$store.state.caja.caja&&!o.$store.state.caja.caja.idOpened?(r(),S("div",Se,[s("div",Ie,[Ne,s("div",He,[e(g,{color:"warning",size:"sm",onClick:l[0]||(l[0]=i=>o.$router.push({name:"apertura"}))},{default:t(()=>[e(y,{icon:"cil-monitor",class:"me-1"}),a(" Aperturar")]),_:1})])])])):L("",!0),c.config&&!c.config.datas.activeStockVenta?(r(),S("div",Pe,[e(C,{color:"warning",class:"d-flex align-items-center mb-1"},{default:t(()=>[e(y,{icon:"cil-warning",class:"me-2",size:"lg"}),Ae,e(g,{color:"success",size:"sm",class:"mt-3 justify-content-md-end",variant:"outline",onClick:l[1]||(l[1]=i=>o.$router.push({name:"config-venta"}))},{default:t(()=>[e(y,{icon:"cil-arrow-right"}),a(" Habilitar ")]),_:1})]),_:1})])):L("",!0),s("div",$e,[e($,{class:"mb-4"},{default:t(()=>[e(v,null,{default:t(()=>[s("div",Ve,[Oe,s("div",Ee,[e(g,{color:"info",onClick:l[2]||(l[2]=i=>c.modalHistory=!0)},{default:t(()=>[e(y,{icon:"cil-clipboard"}),a(" Historial de igresos ")]),_:1})])])]),_:1}),e(A,null,{default:t(()=>[e(_,{responsive:"",hover:""},{default:t(()=>[e(F,null,{default:t(()=>[e(m,null,{default:t(()=>[e(h,{scope:"col"},{default:t(()=>[a("Producto")]),_:1}),e(h,{scope:"col"},{default:t(()=>[a("Estado")]),_:1}),e(h,{scope:"col"},{default:t(()=>[a("Precio")]),_:1}),e(h,{scope:"col"},{default:t(()=>[a("Categoria")]),_:1}),e(h,{scope:"col"},{default:t(()=>[a("Stock")]),_:1}),e(h,{scope:"col"},{default:t(()=>[a("Acciones")]),_:1})]),_:1})]),_:1}),o.list.length>0?(r(),p(T,{key:0},{default:t(()=>[(r(!0),S(K,null,U(c.listFilter,(i,J)=>(r(),p(m,{key:J,onClick:N=>c.data=i},{default:t(()=>[e(f,{scope:"row",class:"p-0"},{default:t(()=>[s("img",{src:i.image?o.$store.getters["product/getSrcImage"](i):c.imageDefault,class:"image-table"},null,8,Re),a(" "+u(i.name),1)]),_:2},1024),e(f,null,{default:t(()=>[e(k,{checked:i.status},null,8,["checked"])]),_:2},1024),e(f,null,{default:t(()=>[a(u(i.price)+" "+u(c.COIN),1)]),_:2},1024),e(f,null,{default:t(()=>{var N;return[a(u((N=i.Category)==null?void 0:N.name),1)]}),_:2},1024),e(f,null,{default:t(()=>[i.stock>10?(r(),p(D,{key:0,color:"success"},{default:t(()=>[a(u(i.stock)+" und.",1)]),_:2},1024)):i.stock<=10&&i.stock>0?(r(),p(D,{key:1,color:"warning"},{default:t(()=>[a(u(i.stock)+" und.",1)]),_:2},1024)):(r(),p(D,{key:2,color:"danger"},{default:t(()=>[a(u(i.stock)+" und.",1)]),_:2},1024))]),_:2},1024),e(f,null,{default:t(()=>[e(g,{color:"info",size:"sm",class:"me-1",onClick:N=>b.setItem(i)},{default:t(()=>[e(y,{icon:"cil-clipboard"}),a(" Ficha Movimientos ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):o.isLoading?(r(),p(T,{key:1},{default:t(()=>[e(m,null,{default:t(()=>[e(f,{colspan:"7",class:"text-center p-4"},{default:t(()=>[e(B,{color:"primary"})]),_:1})]),_:1})]),_:1})):(r(),p(T,{key:2},{default:t(()=>[e(m,null,{default:t(()=>[e(f,{colspan:"7",class:"text-center p-4"},{default:t(()=>[Me]),_:1})]),_:1})]),_:1}))]),_:1}),e(P,{list:o.list,elementosPorPagina:10,onSetData:l[3]||(l[3]=i=>c.listFilter=i)},null,8,["list"])]),_:1})]),_:1})]),s("div",je,[e(d,{data:c.data,onSetData:l[4]||(l[4]=i=>c.data=i)},null,8,["data"])]),s("div",Le,[e(V,{visible:c.modalHistory,onVisible:l[5]||(l[5]=i=>c.modalHistory=i)},null,8,["visible"])])])}const Qe=E(Te,[["render",qe]]);export{Qe as default};
