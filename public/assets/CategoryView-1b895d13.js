import{_ as w,r as s,o as c,e as u,w as o,a as t,b as m,d as a,T as M,Q as k,m as x,K as L,S as T,c as B,j as N,F as A,i as E,t as G}from"./index-0487b031.js";import{e as P}from"./input-45862cdb.js";const $={emits:["visible"],props:{visible:{type:Boolean,default:!1},category:{type:Object,default:null}},data(){return{inputData:{id:null,name:null,description:null},validateForm:null}},methods:{async Validate(e){if(e.preventDefault(),e.currentTarget.checkValidity()===!1&&(e.preventDefault(),e.stopPropagation()),this.validateForm=!0,!this.inputData.name)return;let l;this.category?l=await this.$store.dispatch("category/update",this.inputData):l=await this.$store.dispatch("category/create",this.inputData),l&&this.$emit("visible",!1)},changueFocus(e){const n=P("form-category",e);n&&n.focus()},setData(e=null){if(this.validateForm=!1,!e){this.inputData={id:null,name:null,description:null};return}e!=null&&e.id&&(this.inputData.id=e.id),e!=null&&e.name&&(this.inputData.name=e.name),e!=null&&e.description&&(this.inputData.description=e.description)}},watch:{category:{immediate:!0,handler(e){this.setData(e)}}}},H={class:"row g-3"},O=a("span",{class:"text-danger"},"*",-1);function R(e,n,l,S,i,r){const p=s("CModalTitle"),_=s("CModalHeader"),g=s("CFormLabel"),b=s("CFormInput"),C=s("CFormFeedback"),h=s("CCol"),v=s("CFormTextarea"),D=s("CModalBody"),y=s("CButton"),d=s("CIcon"),F=s("CModalFooter"),V=s("CForm"),I=s("CModal");return c(),u(I,{alignment:"center",visible:l.visible,backdrop:"static",onClose:n[4]||(n[4]=()=>{e.$emit("visible",!1)})},{default:o(()=>[t(V,{class:"needs-validation",novalidate:"",validated:i.validateForm,onSubmit:k(r.Validate,["prevent"]),id:"form-category"},{default:o(()=>[t(_,null,{default:o(()=>[t(p,null,{default:o(()=>[m("Nueva categoria ")]),_:1})]),_:1}),t(D,null,{default:o(()=>[a("div",H,[t(h,{md:12},{default:o(()=>[t(g,{for:"validateForm",class:"mb-0"},{default:o(()=>[m("Nombre "),O]),_:1}),t(b,{id:"validateForm",modelValue:i.inputData.name,"onUpdate:modelValue":n[0]||(n[0]=f=>i.inputData.name=f),required:"",type:"text",name:"name",onKeydown:n[1]||(n[1]=M(k(f=>r.changueFocus("description"),["prevent"]),["enter"]))},null,8,["modelValue"]),t(C,{invalid:""},{default:o(()=>[m(" El nombre del usuario es requerido! ")]),_:1})]),_:1}),t(h,{md:12},{default:o(()=>[t(g,{for:"validateForm",class:"mb-0"},{default:o(()=>[m("Descripcion ")]),_:1}),t(v,{id:"validatedCustom01",modelValue:i.inputData.description,"onUpdate:modelValue":n[2]||(n[2]=f=>i.inputData.description=f),placeholder:"Descripcion...",name:"description",rows:"2"},null,8,["modelValue"])]),_:1})])]),_:1}),t(F,null,{default:o(()=>[t(y,{color:"secondary",type:"button",onClick:n[3]||(n[3]=f=>e.$emit("visible",!1))},{default:o(()=>[m(" Cerrar ")]),_:1}),t(y,{color:"primary",type:"submit"},{default:o(()=>[t(d,{icon:"cil-save"}),m(" Guardar ")]),_:1})]),_:1})]),_:1},8,["validated","onSubmit"])]),_:1},8,["visible"])}const U=w($,[["render",R]]),j={components:{AddCategory:U},data(){return{modalVisible:!1,paramsSelected:null}},computed:{...x("category",["list","isLoading"])},mounted(){this.list.length<=0&&this.loadData()},methods:{...L("category",["loadData"]),getPermissions(e,n){const l=this.$store.getters["auth/getUser"]();return!e.includes(l.rol)},setItem(e){this.paramsSelected=e,this.modalVisible=!0},msgDelete(e){T.fire({title:`Â¿Desea eliminar el registro ${e.name}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#bdbdbd",confirmButtonText:"ELIMINAR",cancelButtonText:"CANCELAR"}).then(n=>{n.isConfirmed&&this.$store.dispatch("category/remove",e.id)})}}},q={class:"row"},z={class:"col"},K={class:"row"},Q=a("div",{class:"col col-sm-6"},[a("h4",{class:"mt-1"},[a("strong",null,"CATEGORIA DE PRODUCTOS")])],-1),J={class:"col col-sm-6 text-end"},W={class:"text-center p-4"},X=a("div",{class:"text-center p-4"},[a("h5",null,"No hay registros!")],-1),Y={class:"col col-12"};function Z(e,n,l,S,i,r){const p=s("CIcon"),_=s("CButton"),g=s("CCardHeader"),b=s("CListGroupItem"),C=s("CListGroup"),h=s("CSpinner"),v=s("CCardBody"),D=s("CCard"),y=s("AddCategory");return c(),B("div",q,[a("div",z,[t(D,{class:"mb-4"},{default:o(()=>[t(g,null,{default:o(()=>[a("div",K,[Q,a("div",J,[r.getPermissions(["admin"])?N("",!0):(c(),u(_,{key:0,color:"primary",size:"md",class:"me-1",onClick:n[0]||(n[0]=d=>{i.modalVisible=!0,i.paramsSelected=null})},{default:o(()=>[t(p,{icon:"cil-plus",class:"me-2"}),m(" Nuevo ")]),_:1}))])])]),_:1}),t(v,null,{default:o(()=>[e.list.length>0?(c(),u(C,{key:0},{default:o(()=>[(c(!0),B(A,null,E(e.list,(d,F)=>(c(),u(b,{class:"d-flex justify-content-between align-items-center",key:F},{default:o(()=>[m(G(d.name)+" ",1),a("div",null,[t(_,{color:"info",size:"sm",class:"me-1",disabled:r.getPermissions(["admin"]),onClick:V=>r.setItem(d)},{default:o(()=>[t(p,{icon:"cil-pencil"})]),_:2},1032,["disabled","onClick"]),t(_,{color:"danger",size:"sm",disabled:r.getPermissions(["admin"]),onClick:V=>r.msgDelete(d)},{default:o(()=>[t(p,{icon:"cil-trash"})]),_:2},1032,["disabled","onClick"])])]),_:2},1024))),128))]),_:1})):e.isLoading?(c(),u(C,{key:1},{default:o(()=>[a("div",W,[t(h,{color:"primary"})])]),_:1})):(c(),u(C,{key:2},{default:o(()=>[X]),_:1}))]),_:1})]),_:1})]),a("div",Y,[t(y,{visible:i.modalVisible,category:i.paramsSelected,onVisible:n[1]||(n[1]=d=>{i.modalVisible=d,i.paramsSelected=null})},null,8,["visible","category"])])])}const oe=w(j,[["render",Z]]);export{oe as default};
