import{_ as E,N as R,O as W,S as x,P as Y,r as a,o as r,e as p,w as t,a as e,Q as N,d as s,b as l,t as u,T as O,L as Z,M as ee,m as G,K as U,c as S,i as z,F as K,a1 as M,j as L}from"./index-0487b031.js";import{e as te}from"./input-45862cdb.js";import{e as q,c as oe}from"./format-date-ea6389fa.js";import{i as Q}from"./picture-093c9837.js";import{P as X}from"./Paginador-20b3a55a.js";const ae={props:{data:{type:Object,default:null}},emits:["setData"],data(){return{inputData:{id:null,date:q(new Date),price:null,amount:0,comment:null},validateForm:null,COIN:R,imageDefault:Q}},methods:{async Validate(o){if(!this.$store.state.caja.caja){W("warning");return}if(o.preventDefault(),o.currentTarget.checkValidity()===!1&&(o.preventDefault(),o.stopPropagation()),this.validateForm=!0,!this.inputData.date){this.changueFocus("date");return}if(!this.inputData.amount){this.changueFocus("amount");return}if(this.inputData.price===null){this.changueFocus("price");return}this.preguntar()},preguntar(){this.$store.state.caja.caja.idOpened?this.saving():x.fire({title:"No se ha efectuado la apertura de caja ¿Desea continuar?",icon:"question",showCancelButton:!0,confirmButtonColor:"#321fdb",cancelButtonColor:"#bdbdbd",confirmButtonText:"ACEPTAR",cancelButtonText:"CANCELAR"}).then(async o=>{o.isConfirmed&&this.saving()})},async saving(){if(this.data){const o=new Date(this.inputData.date);o.setDate(o.getDate()+1),o.setMinutes(new Date().getMinutes()),o.setHours(new Date().getHours()),this.inputData.date=o,await this.$store.dispatch("almacen/create",{...this.inputData,idProducts:this.data.id})&&(this.$emit("setData",null),this.setData())}else Y("Seleccione el producto!","warning")},changueFocus(o){const n=te("form-ingreso-almacen",o);n&&n.focus()},setData(o=null){if(this.validateForm=!1,!o){this.inputData={id:null,date:q(new Date),price:null,amount:0,comment:null};return}this.changueFocus("amount")}},watch:{data:{immediate:!0,handler(o){this.setData(o)}}}},I=o=>(Z("data-v-d0134601"),o=o(),ee(),o),ne=I(()=>s("div",{class:"row"},[s("div",{class:"col col-sm-12"},[s("h5",{class:"mt-1"},[s("strong",null,"REGISTRAR INGRESO")])])],-1)),le={class:"row g-3"},se={class:"col-12"},ce=I(()=>s("span",{class:"text-danger"},"*",-1)),ie=["src"],de={class:"col-12"},re=I(()=>s("span",{class:"text-danger"},"*",-1)),ue={class:"col-12"},me=I(()=>s("span",{class:"text-danger"},"*",-1)),_e={class:"col-12"},pe=I(()=>s("span",{class:"text-danger"},"*",-1)),fe={class:"col-12 col-sm-12"},Ce={class:"col-12 text-end mt-2"};function ge(o,n,k,j,c,b){const D=a("CCardHeader"),v=a("CFormLabel"),C=a("CInputGroupText"),g=a("CFormInput"),h=a("CInputGroup"),m=a("CFormFeedback"),T=a("CFormTextarea"),f=a("CIcon"),w=a("CButton"),y=a("CForm"),F=a("CCardBody"),B=a("CCard");return r(),p(B,{class:"mb-4"},{default:t(()=>[e(D,null,{default:t(()=>[ne]),_:1}),e(F,null,{default:t(()=>[e(y,{class:"needs-validation",novalidate:"",validated:c.validateForm,onSubmit:N(b.Validate,["prevent"]),id:"form-ingreso-almacen"},{default:t(()=>[s("div",le,[s("div",se,[e(v,{for:"validateForm",class:"mb-0"},{default:t(()=>[l("Producto "),ce]),_:1}),e(h,null,{default:t(()=>{var _;return[e(C,{class:"p-0"},{default:t(()=>[s("img",{src:k.data&&k.data.image?o.$store.getters["product/getSrcImage"](k.data):c.imageDefault,class:"image-input"},null,8,ie)]),_:1}),e(g,{id:"validateForm",value:(_=k.data)==null?void 0:_.name,type:"text",name:"product",disabled:""},null,8,["value"])]}),_:1}),e(m,{invalid:""},{default:t(()=>[l(" El total a pagar en "+u(c.COIN)+" es requerido! ",1)]),_:1})]),s("div",de,[e(v,{for:"validatedCustom01",class:"mb-0"},{default:t(()=>[l("Fecha "),re]),_:1}),e(g,{id:"validatedCustom01",modelValue:c.inputData.date,"onUpdate:modelValue":n[0]||(n[0]=_=>c.inputData.date=_),type:"date",name:"date",required:"",onKeydown:n[1]||(n[1]=O(N(_=>b.changueFocus("amount"),["prevent"]),["enter"]))},null,8,["modelValue"]),e(m,{invalid:""},{default:t(()=>[l(" Fecha de de ingreso es requerido! ")]),_:1})]),s("div",ue,[e(v,{for:"validateForm",class:"mb-0"},{default:t(()=>[l("Cantidad "),me]),_:1}),e(g,{id:"validateForm",modelValue:c.inputData.amount,"onUpdate:modelValue":n[2]||(n[2]=_=>c.inputData.amount=_),type:"number",name:"amount",required:"",onKeydown:n[3]||(n[3]=O(N(_=>b.changueFocus("price"),["prevent"]),["enter"]))},null,8,["modelValue"]),e(m,{invalid:""},{default:t(()=>[l(" La cantidad debe ser numerico mayor a cero! ")]),_:1})]),s("div",_e,[e(v,{for:"validateForm",class:"mb-0"},{default:t(()=>[l("Total a pagar "),pe]),_:1}),e(h,null,{default:t(()=>[e(g,{id:"validateForm",modelValue:c.inputData.price,"onUpdate:modelValue":n[4]||(n[4]=_=>c.inputData.price=_),type:"number",name:"price",required:"",onKeydown:n[5]||(n[5]=O(N(_=>b.changueFocus("comment"),["prevent"]),["enter"]))},null,8,["modelValue"]),e(C,null,{default:t(()=>[s("b",null,u(c.COIN),1)]),_:1})]),_:1}),e(m,{invalid:""},{default:t(()=>[l(" El total a pagar en "+u(c.COIN)+" es requerido! ",1)]),_:1})]),s("div",fe,[e(T,{id:"validatedCustom01",label:"Comentario",modelValue:c.inputData.comment,"onUpdate:modelValue":n[6]||(n[6]=_=>c.inputData.comment=_),placeholder:"Comentario...",name:"comment",rows:"2"},null,8,["modelValue"])])]),s("div",Ce,[e(w,{color:"secondary",type:"button",class:"me-1",onClick:n[7]||(n[7]=_=>{b.setData(),this.$emit("setData",null)})},{default:t(()=>[e(f,{icon:"cil-X"}),l(" Limpiar ")]),_:1}),e(w,{color:"primary",type:"submit"},{default:t(()=>[e(f,{icon:"cil-save"}),l(" Registrar ")]),_:1})])]),_:1},8,["validated","onSubmit"])]),_:1})]),_:1})}const ve=E(ae,[["render",ge],["__scopeId","data-v-d0134601"]]),he={props:{visible:{type:Boolean,default:!1}},data(){return{COIN:R,listFilter:[]}},computed:{...G("almacen",["list","isLoading"])},methods:{convertDate:oe,...U("almacen",["loadData"]),msgDelete(o){x.fire({title:`¿Esta seguro que desea cancelar el ingreso de ${o.Product.name}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#bdbdbd",confirmButtonText:"CANCELAR",cancelButtonText:"NO CANCELAR"}).then(n=>{n.isConfirmed&&this.$store.dispatch("almacen/remove",o.id)})}},watch:{visible:{immediate:!0,handler(o){o===!0&&this.list.length<=0&&this.loadData()}}},components:{Paginador:X}},be={class:"row g-3"},ye={class:"col-12 col-md-12"},De=["src"],we=s("h6",null,"No hay registros!",-1);function ke(o,n,k,j,c,b){const D=a("CModalTitle"),v=a("CModalHeader"),C=a("CTableHeaderCell"),g=a("CTableRow"),h=a("CTableHead"),m=a("CTableDataCell"),T=a("CBadge"),f=a("CIcon"),w=a("CButton"),y=a("CTableBody"),F=a("CSpinner"),B=a("CTable"),_=a("Paginador"),H=a("CModalBody"),P=a("CModalFooter"),$=a("CModal");return r(),p($,{alignment:"center",visible:k.visible,backdrop:"static",size:"xl",onClose:n[3]||(n[3]=()=>{o.$emit("visible",!1)})},{default:t(()=>[e(v,null,{default:t(()=>[e(D,null,{default:t(()=>[l("REGISTROS DE INGRESO DE PRODUCTOS ")]),_:1})]),_:1}),e(H,null,{default:t(()=>[s("div",be,[s("div",ye,[e(B,{responsive:"",size:"sm"},{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(C,{scope:"col"},{default:t(()=>[l("Producto")]),_:1}),e(C,{scope:"col"},{default:t(()=>[l("Cantidad")]),_:1}),e(C,{scope:"col"},{default:t(()=>[l("Consto")]),_:1}),e(C,{scope:"col"},{default:t(()=>[l("Fecha")]),_:1}),e(C,{scope:"col"},{default:t(()=>[l("Usuario")]),_:1}),e(C,{scope:"col"},{default:t(()=>[l("Caja")]),_:1}),e(C,{scope:"col"},{default:t(()=>[l("Accion")]),_:1})]),_:1})]),_:1}),o.list.length>0?(r(),p(y,{key:0},{default:t(()=>[(r(!0),S(K,null,z(o.list,(d,A)=>(r(),p(g,{key:A},{default:t(()=>[e(m,{scope:"row",class:"p-0"},{default:t(()=>[s("img",{src:d.Product.image?o.$store.getters["product/getSrcImage"](d.Product):o.imageDefault,class:"image-table"},null,8,De),l(" "+u(d.Product.name),1)]),_:2},1024),e(m,null,{default:t(()=>[d.amount>10?(r(),p(T,{key:0,color:"success"},{default:t(()=>[l(u(d.amount)+" und.",1)]),_:2},1024)):d.amount<=10&&d.amount>0?(r(),p(T,{key:1,color:"warning"},{default:t(()=>[l(u(d.amount)+" und.",1)]),_:2},1024)):(r(),p(T,{key:2,color:"danger"},{default:t(()=>[l(u(d.amount)+" und.",1)]),_:2},1024))]),_:2},1024),e(m,null,{default:t(()=>[l(u(d.price)+" "+u(c.COIN),1)]),_:2},1024),e(m,null,{default:t(()=>[l(u(b.convertDate(d.date)),1)]),_:2},1024),e(m,null,{default:t(()=>[l(u(d.User.name)+" "+u(d.User.lastName||""),1)]),_:2},1024),e(m,null,{default:t(()=>[l(u(d.Caja.name),1)]),_:2},1024),e(m,null,{default:t(()=>[e(w,{color:"danger",size:"sm",class:"me-1",onClick:i=>b.msgDelete(d)},{default:t(()=>[e(f,{icon:"cil-trash"}),l(" Cancelar ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):o.isLoading?(r(),p(y,{key:1},{default:t(()=>[e(g,null,{default:t(()=>[e(m,{colspan:"7",class:"text-center p-4"},{default:t(()=>[e(F,{color:"primary"})]),_:1})]),_:1})]),_:1})):(r(),p(y,{key:2},{default:t(()=>[e(g,null,{default:t(()=>[e(m,{colspan:"7",class:"text-center p-4"},{default:t(()=>[we]),_:1})]),_:1})]),_:1}))]),_:1}),e(_,{list:o.list,elementosPorPagina:10,onSetData:n[0]||(n[0]=d=>c.listFilter=d)},null,8,["list"])])])]),_:1}),e(P,null,{default:t(()=>[e(w,{color:"success",type:"button",onClick:n[1]||(n[1]=d=>o.loadData())},{default:t(()=>[e(f,{icon:"cil-sync"}),l(" Actualizar ")]),_:1}),e(w,{color:"primary",type:"button",onClick:n[2]||(n[2]=d=>o.$emit("visible",!1))},{default:t(()=>[l(" Aceptar ")]),_:1})]),_:1})]),_:1},8,["visible"])}const Te=E(he,[["render",ke]]),Fe={data(){return{data:null,COIN:R,imageDefault:Q,modalHistory:!1,config:null,listFilter:[]}},computed:{...G("product",["list","isLoading"])},mounted(){this.list.length<=0&&this.loadData(),this.config=this.$store.getters["config/getByName"](M)},methods:{...U("product",["loadData"]),setItem(o){console.log(o)}},watch:{"$store.state.config.config"(o){o&&(this.config=this.$store.getters["config/getByName"](M))}},components:{NewStock:ve,HistoryAlmacen:Te,Paginador:X}},Be={class:"row"},Se={key:0,class:"col col-12"},Ie={class:"alert alert-warning row",role:"alert"},Ne=s("div",{class:"col-12 col-sm-8"},[s("b",null,"Advertencia!"),l(" No se ha efectuado la apertura de caja! ")],-1),He={class:"col-12 col-sm-4 text-end"},Pe={key:1,class:"col-12"},$e=s("div",null,[s("b",null,"IMPORTANTE"),l(" Es importante tener en cuenta que las ventas no maneja el control de stock. Esto significa que las ventas se pueden realizar aunque no haya suficiente stock disponible para el producto en cuestión ")],-1),Ae={class:"col col-12 col-sm-8"},Ve={class:"row"},Oe=s("div",{class:"col-12 col-sm-6"},[s("h5",{class:"mt-1"},[s("strong",null,"STOCK DE PRODUCTOS")])],-1),Ee={class:"col-12 col-sm-6 text-end"},Re=["src"],je=s("h6",null,"No hay registros!",-1),Me={class:"col col-12 col-sm-4"},Le={class:"col-12"};function qe(o,n,k,j,c,b){const D=a("CIcon"),v=a("CButton"),C=a("CAlert"),g=a("CCardHeader"),h=a("CTableHeaderCell"),m=a("CTableRow"),T=a("CTableHead"),f=a("CTableDataCell"),w=a("CFormSwitch"),y=a("CBadge"),F=a("CTableBody"),B=a("CSpinner"),_=a("CTable"),H=a("Paginador"),P=a("CCardBody"),$=a("CCard"),d=a("NewStock"),A=a("HistoryAlmacen");return r(),S("div",Be,[o.$store.state.caja.caja&&!o.$store.state.caja.caja.idOpened?(r(),S("div",Se,[s("div",Ie,[Ne,s("div",He,[e(v,{color:"warning",size:"sm",onClick:n[0]||(n[0]=i=>o.$router.push({name:"apertura"}))},{default:t(()=>[e(D,{icon:"cil-monitor",class:"me-1"}),l(" Aperturar")]),_:1})])])])):L("",!0),c.config&&!c.config.datas.activeStockVenta?(r(),S("div",Pe,[e(C,{color:"warning",class:"d-flex align-items-center mb-1"},{default:t(()=>[e(D,{icon:"cil-warning",class:"me-2",size:"lg"}),$e,e(v,{color:"success",size:"sm",class:"mt-3 justify-content-md-end",variant:"outline",onClick:n[1]||(n[1]=i=>o.$router.push({name:"config-venta"}))},{default:t(()=>[e(D,{icon:"cil-arrow-right"}),l(" Habilitar ")]),_:1})]),_:1})])):L("",!0),s("div",Ae,[e($,{class:"mb-4"},{default:t(()=>[e(g,null,{default:t(()=>[s("div",Ve,[Oe,s("div",Ee,[e(v,{color:"info",onClick:n[2]||(n[2]=i=>c.modalHistory=!0)},{default:t(()=>[e(D,{icon:"cil-clipboard"}),l(" Historial de igresos ")]),_:1})])])]),_:1}),e(P,null,{default:t(()=>[e(_,{responsive:"",hover:""},{default:t(()=>[e(T,null,{default:t(()=>[e(m,null,{default:t(()=>[e(h,{scope:"col"},{default:t(()=>[l("Producto")]),_:1}),e(h,{scope:"col"},{default:t(()=>[l("Estado")]),_:1}),e(h,{scope:"col"},{default:t(()=>[l("Precio")]),_:1}),e(h,{scope:"col"},{default:t(()=>[l("Categoria")]),_:1}),e(h,{scope:"col"},{default:t(()=>[l("Stock")]),_:1})]),_:1})]),_:1}),o.list.length>0?(r(),p(F,{key:0},{default:t(()=>[(r(!0),S(K,null,z(c.listFilter,(i,J)=>(r(),p(m,{key:J,onClick:V=>c.data=i},{default:t(()=>[e(f,{scope:"row",class:"p-0"},{default:t(()=>[s("img",{src:i.image?o.$store.getters["product/getSrcImage"](i):c.imageDefault,class:"image-table"},null,8,Re),l(" "+u(i.name),1)]),_:2},1024),e(f,null,{default:t(()=>[e(w,{checked:i.status},null,8,["checked"])]),_:2},1024),e(f,null,{default:t(()=>[l(u(i.price)+" "+u(c.COIN),1)]),_:2},1024),e(f,null,{default:t(()=>{var V;return[l(u((V=i.Category)==null?void 0:V.name),1)]}),_:2},1024),e(f,null,{default:t(()=>[i.stock>10?(r(),p(y,{key:0,color:"success"},{default:t(()=>[l(u(i.stock)+" und.",1)]),_:2},1024)):i.stock<=10&&i.stock>0?(r(),p(y,{key:1,color:"warning"},{default:t(()=>[l(u(i.stock)+" und.",1)]),_:2},1024)):(r(),p(y,{key:2,color:"danger"},{default:t(()=>[l(u(i.stock)+" und.",1)]),_:2},1024))]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):o.isLoading?(r(),p(F,{key:1},{default:t(()=>[e(m,null,{default:t(()=>[e(f,{colspan:"7",class:"text-center p-4"},{default:t(()=>[e(B,{color:"primary"})]),_:1})]),_:1})]),_:1})):(r(),p(F,{key:2},{default:t(()=>[e(m,null,{default:t(()=>[e(f,{colspan:"7",class:"text-center p-4"},{default:t(()=>[je]),_:1})]),_:1})]),_:1}))]),_:1}),e(H,{list:o.list,elementosPorPagina:10,onSetData:n[3]||(n[3]=i=>c.listFilter=i)},null,8,["list"])]),_:1})]),_:1})]),s("div",Me,[e(d,{data:c.data,onSetData:n[4]||(n[4]=i=>c.data=i)},null,8,["data"])]),s("div",Le,[e(A,{visible:c.modalHistory,onVisible:n[5]||(n[5]=i=>c.modalHistory=i)},null,8,["visible"])])])}const Qe=E(Fe,[["render",qe]]);export{Qe as default};
