import{e as B}from"./input-45862cdb.js";import{I}from"./InputPhone-652e83e5.js";import{_ as v,r as l,o as _,e as T,w as a,a as n,b as s,t as E,d as F,T as f,c as C,j as D,Q as r}from"./index-0487b031.js";const K={emits:["visible","setData"],props:{visible:{type:Boolean,default:!1},client:{type:Object,default:null},code:{type:String,default:null}},data(){return{inputData:{id:null,name:null,lastName:null,email:null,ci:null,phone:null},submited:!1,validateForm:null,dataPhone:null}},methods:{async Validate(e){var h;if(this.submited=!0,e.preventDefault(),e.currentTarget.checkValidity()===!1&&(e.preventDefault(),e.stopPropagation()),!this.inputData.name){this.changueFocus("name");return}if((h=this.dataPhone)!=null&&h.number){if(!this.dataPhone.isValid||!this.dataPhone.number){this.changueFocus("phone");return}if(!this.dataPhone.number.includes("+")){const o="+"+this.dataPhone.country+this.dataPhone.number;this.inputData.phone=o}}let u;this.client?u=await this.$store.dispatch("client/update",this.inputData):u=await this.$store.dispatch("client/create",this.inputData),u&&(this.$emit("setData",u),this.$emit("visible",!1),this.setData(null))},changueFocus(e){const t=B("form-client",e);t&&t.focus()},setData(e=null){if(!e){this.inputData={id:null,name:null,lastName:null,email:null,ci:null,phone:null},this.dataPhone=null;return}e!=null&&e.id&&(this.inputData.id=e.id),e!=null&&e.name&&(this.inputData.name=e.name),e!=null&&e.lastName&&(this.inputData.lastName=e.lastName),e!=null&&e.phone&&(this.inputData.phone=e.phone,this.dataPhone={number:e.phone,isValid:!0}),e!=null&&e.ci&&(this.inputData.ci=e.ci),e!=null&&e.email&&(this.inputData.email=e.email)}},watch:{client:{immediate:!0,handler(e){this.setData(e)}},code:{immediate:!0,handler(e){this.inputData.ci=e}},visible(e){e&&setTimeout(()=>{this.changueFocus("name")},300)}},components:{InputPhone:I}},S={class:"row g-3"},A=F("span",{class:"text-danger"},"*",-1),U={key:0,class:"invalid-text"},q={key:0,class:"invalid-text"};function j(e,t,u,h,o,d){const y=l("CModalTitle"),V=l("CModalHeader"),p=l("CFormLabel"),c=l("CFormInput"),m=l("CCol"),g=l("InputPhone"),P=l("CFormFeedback"),N=l("CModalBody"),b=l("CButton"),w=l("CIcon"),M=l("CModalFooter"),k=l("CForm"),x=l("CModal");return _(),T(x,{alignment:"center",visible:u.visible,backdrop:"static",onClose:t[10]||(t[10]=()=>{e.$emit("visible",!1)})},{default:a(()=>[n(k,{class:"needs-validation",validated:o.validateForm,onSubmit:r(d.Validate,["prevent"]),id:"form-client"},{default:a(()=>[n(V,null,{default:a(()=>[n(y,null,{default:a(()=>[s(E(u.client?"Editar cliente":"Agregar nuevo cliente"),1)]),_:1})]),_:1}),n(N,null,{default:a(()=>[F("div",S,[n(m,{md:6},{default:a(()=>[n(p,{for:"validateForm",class:"mb-0"},{default:a(()=>[s("Nombre "),A]),_:1}),n(c,{id:"validateForm",modelValue:o.inputData.name,"onUpdate:modelValue":t[0]||(t[0]=i=>o.inputData.name=i),type:"text",name:"name",onKeydown:t[1]||(t[1]=f(r(i=>d.changueFocus("lastName"),["prevent"]),["enter"]))},null,8,["modelValue"]),o.submited&&!o.inputData.name?(_(),C("div",U," El nombre del usuario es requerido! ")):D("",!0)]),_:1}),n(m,{md:6},{default:a(()=>[n(p,{for:"validateForm",class:"mb-0"},{default:a(()=>[s("Apellido")]),_:1}),n(c,{id:"validateForm",modelValue:o.inputData.lastName,"onUpdate:modelValue":t[2]||(t[2]=i=>o.inputData.lastName=i),type:"text",name:"lastName",onKeydown:t[3]||(t[3]=f(r(i=>d.changueFocus("ci"),["prevent"]),["enter"]))},null,8,["modelValue"])]),_:1}),n(m,{sm:12,md:6},{default:a(()=>[n(p,{for:"validateForm",class:"mb-0"},{default:a(()=>[s("Numero de carnet")]),_:1}),n(c,{id:"validateForm",modelValue:o.inputData.ci,"onUpdate:modelValue":t[4]||(t[4]=i=>o.inputData.ci=i),type:"text",name:"ci",onKeydown:t[5]||(t[5]=f(r(i=>d.changueFocus("phone"),["prevent"]),["enter"]))},null,8,["modelValue"])]),_:1}),n(m,{sm:12,md:6},{default:a(()=>[n(g,{value:o.dataPhone,required:!1,onSetValue:t[6]||(t[6]=i=>o.dataPhone=i),onKeypress:t[7]||(t[7]=f(r(i=>d.changueFocus("email"),["prevent"]),["enter"]))},null,8,["value"]),o.submited&&o.dataPhone&&!o.dataPhone.isValid?(_(),C("div",q," El numero de telefono no es valido! ")):D("",!0)]),_:1}),n(m,{md:12},{default:a(()=>[n(p,{for:"validateForm",class:"mb-0"},{default:a(()=>[s("Correo electronico ")]),_:1}),n(c,{id:"validateForm",modelValue:o.inputData.email,"onUpdate:modelValue":t[8]||(t[8]=i=>o.inputData.email=i),type:"email",name:"email"},null,8,["modelValue"]),n(P,{invalid:""},{default:a(()=>[s(" El correo electronico es requerido! ")]),_:1})]),_:1})])]),_:1}),n(M,null,{default:a(()=>[n(b,{color:"secondary",type:"button",onClick:t[9]||(t[9]=i=>e.$emit("visible",!1))},{default:a(()=>[s(" Cerrar ")]),_:1}),n(b,{color:"primary",type:"submit"},{default:a(()=>[n(w,{icon:"cil-save"}),s(" Guardar ")]),_:1})]),_:1})]),_:1},8,["validated","onSubmit"])]),_:1},8,["visible"])}const O=v(K,[["render",j]]);export{O as A};
